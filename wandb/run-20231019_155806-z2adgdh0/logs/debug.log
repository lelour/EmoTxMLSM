2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_setup.py:_flush():76] Configure stats pid to 225900
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_setup.py:_flush():76] Loading settings from /home/powerop/.config/wandb/settings
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_setup.py:_flush():76] Loading settings from /home/powerop/work/dense/EmoTx/EmoTx-CVPR2023/wandb/settings
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'trainer.py', 'program': 'trainer.py'}
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_init.py:_log_setup():461] Logging user logs to /home/powerop/work/dense/EmoTx/EmoTx-CVPR2023/wandb/run-20231019_155806-z2adgdh0/logs/debug.log
2023-10-19 15:58:06,375 INFO    MainThread:225900 [wandb_init.py:_log_setup():462] Logging internal logs to /home/powerop/work/dense/EmoTx/EmoTx-CVPR2023/wandb/run-20231019_155806-z2adgdh0/logs/debug-internal.log
2023-10-19 15:58:06,376 INFO    MainThread:225900 [wandb_init.py:init():495] calling init triggers
2023-10-19 15:58:06,376 INFO    MainThread:225900 [wandb_init.py:init():499] wandb.init called with sweep_config: {}
config: {'data_path': '/data/share_user/EmoTx/data', 'resource_path': '/data/share_user/EmoTx/data/MovieGraph/resources/', 'clip_srts_path': '/data/share_user/EmoTx/data/MovieGraph/srt/clip_srt/', 'emotic_mapping_path': '/data/share_user/EmoTx/data/emotic_mapping.json', 'pkl_path': '/data/share_user/EmoTx/data/MovieGraph/mg/py3loader/', 'save_path': './checkpoints/', 'saved_model_path': '/data/share_user/EmoTx/data/pretrained_models/', 'hugging_face_cache_path': '../cache/', 'dumps_path': './dumps', 'scene_feat_dir': '_scene_features', 'face_feat_dir': '_face_features', 'srt_feat_dir': 'srt_feats', 'tracks_dir': 'character_tracks', 'track_names_dir': 'track_names', 'track_name_metadata_dir': 'track_names/metadata', 'mg_videos_dir': 'mg_videos', 'scene_feat_type': 'mvit_v1', 'face_feat_type': 'resnet50_fer', 'srt_feat_type': 'independent', 'srt_feat_model': 'roberta', 'pkl_name': '2017-11-02-51-7637_py3.pkl', 'char_detection': {'person_config': 'cascade_rcnn_x101_64x4d_fpn.json', 'face_config': 'mtcnn.json', 'person_det_model': 'cascade_rcnn_x101_64x4d_fpn.pth', 'face_det_model': 'mtcnn.pth', 'save_path': None}, 'use_scene_feats': True, 'use_char_feats': True, 'use_srt_feats': True, 'get_scene_targets': True, 'get_char_targets': True, 'random_feat_selection': True, 'use_srt_cls_only': True, 'joint_character_modeling': True, 'srt_feat_pretrained': False, 'use_emotic_mapping': False, 'shuffle_characters': False, 'model_no': 4.0, 'vid_fps': 23.976023976023978, 'max_possible_vid_frame_no': 17500, 'character_name_selection_threshold': 0.5, 'target_prediction_threshold': 0.5, 'top_k': 10, 'feat_sampling_rate': 8, 'num_chars': 4, 'num_enc_layers': 2, 'max_feats': 300, 'max_srt_feats': 300, 'batch_size': 4, 'num_cpus': 9, 'epochs': 20, 'lr': 1e-05, 'gpu_id': 0, 'seed': 0, 'wandb': {'logging': True, 'project': 'emotx_cs577', 'entity': 'lelour1217', 'sweeps': False, 'sweep_id': '', 'sweep_run_count': 100}, 'model_name': 'M4_0.L2.N4.e5.t10.mS.rC.inFrSr.8_', 'model_name_suffix': '', 'action_feat_group_size': 32, 'feat_info': {'generic': {'scene_feat_dim': 2048, 'face_feat_dim': 512}, 'emo': {'face_feat_dim': 4096, 'weights': 'vgg_m_face_bn_fer_dag.pth'}, 'resnet50_places': {'scene_feat_dim': 2048, 'weights': 'resnet50_places365.pth.tar'}, 'resnet50_fer': {'face_feat_dim': 2048, 'weights': 'resnet50_fer.pth'}, 'roberta': {'srt_feat_dim': 768}, 'mvit_v1': {'scene_feat_dim': 768, 'weights': 'MVIT_B_32x3_f294077834.pyth'}}, 'pos_weight': {'10': [2.67218201, 2.91079295, 2.36587678, 4.29210134, 3.74098798, 4.70900322, 4.57456829, 4.96806723, 4.72741935, 5.60037175], '25': [3.76215098, 4.0715859, 3.36492891, 5.86289121, 5.1481976, 6.40353698, 6.22919937, 6.7394958, 6.42741935, 7.55947955, 8.63389121, 8.3597561, 8.26559356, 9.41855204, 8.39795918, 10.74744898, 11.75623269, 10.09638554, 10.93005181, 12.15714286, 12.62426036, 14.98958333, 12.70535714, 16.18283582, 17.56854839], '26': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}}
2023-10-19 15:58:06,376 INFO    MainThread:225900 [wandb_init.py:init():548] starting backend
2023-10-19 15:58:06,376 INFO    MainThread:225900 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-10-19 15:58:06,456 INFO    MainThread:225900 [backend.py:ensure_launched():217] starting backend process...
2023-10-19 15:58:06,553 INFO    MainThread:225900 [backend.py:ensure_launched():222] started backend process with pid: 227605
2023-10-19 15:58:06,555 INFO    MainThread:225900 [wandb_init.py:init():558] backend started and connected
2023-10-19 15:58:06,571 INFO    MainThread:225900 [wandb_init.py:init():634] updated telemetry
2023-10-19 15:58:06,953 INFO    MainThread:225900 [wandb_init.py:init():666] communicating run to backend with 30 second timeout
2023-10-19 15:58:36,956 INFO    MainThread:225900 [interface_shared.py:_communicate_run():326] couldn't get run from backend
2023-10-19 15:58:36,956 ERROR   MainThread:225900 [wandb_init.py:init():674] backend process timed out
2023-10-19 15:58:36,956 ERROR   MainThread:225900 [wandb_init.py:init():685] encountered error: Error communicating with wandb process
try: wandb.init(settings=wandb.Settings(start_method='fork'))
or:  wandb.init(settings=wandb.Settings(start_method='thread'))
For more info see: https://docs.wandb.ai/library/init#init-start-error
2023-10-19 15:59:10,826 WARNING MainThread:225900 [wandb_init.py:init():1064] interrupted
Traceback (most recent call last):
  File "/home/powerop/.local/lib/python3.6/site-packages/wandb/sdk/wandb_init.py", line 1043, in init
    run = wi.init()
  File "/home/powerop/.local/lib/python3.6/site-packages/wandb/sdk/wandb_init.py", line 689, in init
    backend.cleanup()
  File "/home/powerop/.local/lib/python3.6/site-packages/wandb/sdk/backend/backend.py", line 248, in cleanup
    self.wandb_process.join()
  File "/opt/app/conda/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/opt/app/conda/lib/python3.6/multiprocessing/popen_fork.py", line 50, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/opt/app/conda/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
KeyboardInterrupt
